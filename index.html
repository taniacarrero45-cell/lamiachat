<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <title>ARENA PRO 2026 - COMPLETA</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gun/0.2020.1239/gun.min.js"></script>
    <style>
        body { background: #000; color: #fff; font-family: 'Segoe UI', sans-serif; margin: 0; display: flex; height: 100vh; overflow: hidden; }
        
        /* Layout a 3 Colonne */
        #col-utenti { width: 220px; border-right: 2px solid #ff00ff; background: #050505; display: flex; flex-direction: column; }
        #col-centrale { flex: 1; display: flex; flex-direction: column; border-right: 2px solid #00f2ff; }
        #col-regia { width: 350px; background: #0a0a0a; padding: 15px; display: flex; flex-direction: column; gap: 15px; }

        /* Componenti */
        .header { padding: 15px; text-align: center; font-weight: bold; color: #ff00ff; border-bottom: 1px solid #222; }
        #chat { flex: 1; overflow-y: auto; padding: 20px; background: rgba(255,255,255,0.02); }
        .msg { margin-bottom: 12px; padding: 10px; background: #111; border-radius: 8px; border-left: 4px solid #00f2ff; }
        
        .box-media { background: #111; border: 1px solid #333; border-radius: 12px; overflow: hidden; }
        iframe { width: 100%; aspect-ratio: 16/9; border: none; }
        
        .btn-arena { background: #ff00ff; color: #fff; border: none; padding: 12px; border-radius: 8px; cursor: pointer; font-weight: bold; width: 100%; }
        .btn-quiz { background: #00f2ff; color: #000; }
        
        input { background: #111; color: #fff; border: 1px solid #444; padding: 12px; border-radius: 8px; outline: none; }
        #login { position: fixed; inset: 0; background: #000; z-index: 10000; display: flex; align-items: center; justify-content: center; }
        
        .user-item { padding: 10px; color: #00f2ff; border-bottom: 1px solid #1a1a1a; cursor: pointer; }
        .user-item:hover { background: #111; }
    </style>
</head>
<body>

<div id="login">
    <div style="border: 2px solid #ff00ff; padding: 40px; border-radius: 20px; text-align: center; background: #0a0a0a;">
        <h1 style="color:#00f2ff">ARENA ACCESSO</h1>
        <input type="text" id="nick" placeholder="Tuo Nickname..."><br><br>
        <button onclick="entra()" class="btn-arena">ENTRA ORA</button>
    </div>
</div>

<div id="col-utenti">
    <div class="header">ONLINE</div>
    <div id="u-list"></div>
</div>

<div id="col-centrale">
    <div id="chat"></div>
    <div style="padding:20px; background: #0a0a0a; display:flex; gap:10px;">
        <input type="text" id="m-in" style="flex:1" placeholder="Scrivi nell'Arena..." onkeypress="if(event.key==='Enter') invia()">
        <button onclick="invia()" class="btn-arena" style="width:100px;">INVIA</button>
    </div>
</div>

<div id="col-regia">
    <div class="header" style="color:#00f2ff">MEDIA REGIA</div>
    
    <div class="box-media">
        <iframe src="https://www.youtube.com/embed/jfKfPfyJRdk" allowfullscreen></iframe>
    </div>

    <div class="box-media" style="padding:15px; text-align:center;">
        <h4 style="margin:0; color:gold;">QUIZ & GIOCHI</h4>
        <p style="font-size:12px; color:#888;">Sfida i tuoi amici in tempo reale!</p>
        <button class="btn-arena btn-quiz" onclick="alert('Quiz Avviato!')">AVVIA ROUND</button>
    </div>

    <div class="box-media" style="padding:15px; text-align:center;">
        <button class="btn-arena" style="background:#ff0055;" onclick="alert('Camera in attivazione...')">üé• WEBCAM ON</button>
        <div id="v-grid" style="margin-top:10px; font-size:11px; color:#444;">Nessun segnale video</div>
    </div>
</div>

<script>
    const gun = Gun(['https://gun-manhattan.herokuapp.com/gun']);
    const db = gun.get('arena_orgogliosa_2026_top'); // Database nuovo e pulito
    let mioNick = "";

    function entra() {
        mioNick = document.getElementById('nick').value.trim();
        if(!mioNick) return;
        document.getElementById('login').style.display = 'none';
        db.get('u').get(mioNick).put({n: mioNick, t: Date.now()});
    }

    function invia() {
        let txt = document.getElementById('m-in').value;
        if(!txt) return;
        db.get('m').set({u: mioNick, t: txt, ora: Date.now()});
        document.getElementById('m-in').value = "";
    }

    db.get('m').map().once(d => {
        if(!d) return;
        let div = document.createElement('div');
        div.className = 'msg';
        div.innerHTML = `<b style="color:#00f2ff">${d.u}:</b> ${d.t}`;
        document.getElementById('chat').appendChild(div);
        document.getElementById('chat').scrollTop = 9999;
    });

    db.get('u').map().on((d, id) => {
        if(!d || document.getElementById('u-'+id)) return;
        let el = document.createElement('div');
        el.id = 'u-'+id; el.className = 'user-item';
        el.innerText = "‚óè " + id;
        document.getElementById('u-list').appendChild(el);
    });
</script>
</body>
</html>
