<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ARENA LIVE 2026 - UFFICIALE</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gun/0.2020.1239/gun.min.js"></script>
    <script src="https://www.youtube.com/iframe_api"></script>
    <style>
        body { margin: 0; background: #000; color: #fff; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; display: flex; height: 100vh; overflow: hidden; }
        
        /* LOGIN */
        #login { position: fixed; inset: 0; background: #000; display: flex; align-items: center; justify-content: center; z-index: 10000; }
        .login-card { background: #111; padding: 50px; border: 2px solid #ff00ff; border-radius: 15px; text-align: center; box-shadow: 0 0 20px #ff00ff55; }
        
        /* COLONNE */
        #col-utenti { width: 220px; border-right: 1px solid #333; background: #050505; display: flex; flex-direction: column; }
        #col-centrale { flex: 1; display: flex; flex-direction: column; background: #000; }
        #col-destra { width: 380px; border-left: 1px solid #333; background: #050505; display: flex; flex-direction: column; padding: 10px; gap: 10px; }

        /* LISTA UTENTI */
        .u-header { padding: 15px; text-align: center; color: #ff00ff; border-bottom: 1px solid #333; font-weight: bold; }
        .user-link { padding: 12px; cursor: pointer; border-bottom: 1px solid #111; color: #00f2ff; transition: 0.3s; }
        .user-link:hover { background: #111; color: #ff00ff; }

        /* CHAT */
        #chat-box { flex: 1; overflow-y: auto; padding: 20px; }
        .msg { margin-bottom: 10px; background: #111; padding: 10px; border-radius: 5px; border-left: 3px solid #00f2ff; }
        .input-area { padding: 20px; background: #0a0a0a; display: flex; gap: 10px; }
        input { background: #111; color: #fff; border: 1px solid #444; padding: 12px; border-radius: 5px; flex: 1; }
        button { background: #ff00ff; color: #fff; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-weight: bold; }

        /* DESTRA: YOUTUBE, GIOCO, WEBCAM */
        .box-destra { background: #111; border-radius: 10px; overflow: hidden; border: 1px solid #222; }
        #yt-player { width: 100%; aspect-ratio: 16/9; }
        #game-box { padding: 15px; height: 120px; text-align: center; }
        #webcam-box { flex: 1; overflow-y: auto; padding: 10px; border-top: 1px solid #333; }
        .cam-btn { background: #00f2ff; color: #000; width: 100%; margin-bottom: 10px; }
    </style>
</head>
<body>

<div id="login">
    <div class="login-card">
        <h2 style="color:#00f2ff">ARENA LIVE 2026</h2>
        <input type="text" id="nick" placeholder="Tuo Nickname..."><br><br>
        <button onclick="entra()">ENTRA ORA</button>
    </div>
</div>

<div id="col-utenti">
    <div class="u-header">ONLINE</div>
    <div id="u-list"></div>
</div>

<div id="col-centrale">
    <div id="chat-box"></div>
    <div class="input-area">
        <input type="text" id="m-in" placeholder="Scrivi un messaggio..." onkeypress="if(event.key==='Enter') invia()">
        <button onclick="invia()">INVIA</button>
    </div>
</div>

<div id="col-destra">
    <div class="box-destra" title="YouTube">
        <div id="yt-player"></div>
    </div>
    
    <div class="box-destra" id="game-box">
        <h4 style="margin:0; color:gold">ARENA QUIZ</h4>
        <p id="quiz-msg" style="font-size:13px">Pronto per il gioco? <br>Attendi l'inizio...</p>
        <button onclick="alert('Gioco in arrivo!')" style="background:#444; font-size:11px">PARTECIPA</button>
    </div>

    <div id="webcam-box">
        <button class="cam-btn" onclick="toggleCam()">ðŸŽ¥ ATTIVA WEBCAM</button>
        <div id="video-grid" style="color:#444; font-size:12px; text-align:center">Nessuna webcam attiva</div>
    </div>
</div>

<script>
    let mioNick = "";
    const gun = Gun(['https://gun-manhattan.herokuapp.com/gun']);
    const db = gun.get('arena_unificata_2026');

    function entra() {
        mioNick = document.getElementById('nick').value.trim();
        if(!mioNick) return;
        document.getElementById('login').style.display = 'none';
        db.get('utenti').get(mioNick).put({nome: mioNick, t: Date.now()});
    }

    function invia() {
        let txt = document.getElementById('m-in').value;
        if(!txt) return;
        db.get('chat').set({u: mioNick, t: txt, ora: Date.now()});
        document.getElementById('m-in').value = "";
    }

    // Ricezione Chat
    db.get('chat').map().once(d => {
        if(!d) return;
        let div = document.createElement('div');
        div.className = 'msg';
        div.innerHTML = `<b style="color:#00f2ff">${d.u}:</b> ${d.t}`;
        document.getElementById('chat-box').appendChild(div);
        document.getElementById('chat-box').scrollTop = 9999;
    });

    // Lista Utenti
    db.get('utenti').map().on((d, id) => {
        if(!d || document.getElementById('u-'+id)) return;
        let el = document.createElement('div');
        el.id = 'u-'+id; el.className = 'user-link';
        el.innerText = "â— " + id;
        el.onclick = () => { document.getElementById('m-in').value = "/privato " + id + " "; document.getElementById('m-in').focus(); };
        document.getElementById('u-list').appendChild(el);
    });

    // YouTube
    var player;
    function onYouTubeIframeAPIReady() {
        player = new YT.Player('yt-player', {
            videoId: 'jfKfPfyJRdk',
            width: '100%',
            height: '100%',
            playerVars: { 'autoplay': 1, 'controls': 1 }
        });
    }
    
    function toggleCam() {
        alert("Accesso alla camera richiesto...");
        document.getElementById('video-grid').innerText = "Camera in attivazione...";
    }
</script>
</body>
</html>
