<!DOCTYPE html>
<html>
<head>
    <title>ARENA LIVE - OFFICIAL</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gun/0.2020.1239/gun.min.js"></script>
    <style>
        body { background: #000; color: #fff; font-family: sans-serif; margin: 0; display: flex; height: 100vh; }
        #side { width: 200px; background: #050505; border-right: 2px solid #ff00ff; padding: 10px; }
        #main { flex: 1; display: flex; flex-direction: column; background: #000; }
        #chat { flex: 1; overflow-y: auto; padding: 20px; font-size: 18px; }
        .msg { margin-bottom: 10px; border-bottom: 1px solid #222; padding: 5px; }
        .user { color: #00f2ff; font-weight: bold; }
        .bar { padding: 20px; background: #111; display: flex; gap: 10px; }
        input { flex: 1; padding: 15px; background: #000; color: #fff; border: 1px solid #ff00ff; border-radius: 10px; }
        button { padding: 10px 20px; background: #ff00ff; color: #fff; border: none; border-radius: 10px; cursor: pointer; }
        #video-box { position: fixed; top: 10px; right: 10px; width: 300px; height: 180px; border: 2px solid #00f2ff; background: #000; z-index: 100; }
        #login { position: fixed; inset: 0; background: #000; z-index: 1000; display: flex; align-items: center; justify-content: center; }
    </style>
</head>
<body>
    <div id="login">
        <div style="text-align:center; border: 2px solid #ff00ff; padding: 30px; border-radius: 20px;">
            <h2 style="color:#ff00ff">BENVENUTI NELL'ARENA</h2>
            <input type="text" id="nick" placeholder="Nome..."><br><br>
            <button onclick="entra()">ENTRA ORA</button>
        </div>
    </div>

    <div id="side">
        <h3 style="color:#00f2ff">ONLINE</h3>
        <div id="users"></div>
    </div>

    <div id="main">
        <div id="chat"></div>
        <div class="bar">
            <input type="text" id="input" placeholder="Scrivi un messaggio...">
            <button onclick="send()">INVIA</button>
        </div>
    </div>

    <div id="video-box">
        <iframe width="100%" height="100%" src="https://www.youtube.com/embed/live_stream?channel=UC4R8DWoMoI7CAwX8_LjQHig" frameborder="0" allowfullscreen></iframe>
    </div>

    <script>
        const gun = Gun(['https://gun-manhattan.herokuapp.com/gun']);
        const db = gun.get('arena_top_secret_2026');
        let myNick = "";

        function entra() {
            myNick = document.getElementById('nick').value;
            if(myNick) document.getElementById('login').style.display='none';
            db.get('u').get(myNick).put({n: myNick});
        }

        function send() {
            let t = document.getElementById('input').value;
            if(t) db.get('m').set({u: myNick, t: t});
            document.getElementById('input').value = "";
        }

        db.get('m').map().once(d => {
            let m = document.createElement('div');
            m.className = 'msg';
            m.innerHTML = `<span class="user">${d.u}:</span> ${d.t}`;
            document.getElementById('chat').appendChild(m);
            document.getElementById('chat').scrollTop = 99999;
        });

        db.get('u').map().on((d, id) => {
            if(!document.getElementById('u-'+id)) {
                let u = document.createElement('div');
                u.id = 'u-'+id; u.innerText = "‚óè " + id; u.style.color = "#00f2ff";
                document.getElementById('users').appendChild(u);
            }
        });
    </script>
</body>
</html>
